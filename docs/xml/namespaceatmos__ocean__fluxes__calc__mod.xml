<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.14">
  <compounddef id="namespaceatmos__ocean__fluxes__calc__mod" kind="namespace" language="Fortran">
    <compoundname>atmos_ocean_fluxes_calc_mod</compoundname>
      <sectiondef kind="var">
      <memberdef kind="variable" id="namespaceatmos__ocean__fluxes__calc__mod_1ac9291db41140417d091d7d400d3764eb" prot="private" static="no" mutable="no">
        <type>character(len= *), parameter</type>
        <definition>character(len=*), parameter atmos_ocean_fluxes_calc_mod::mod_name</definition>
        <argsstring></argsstring>
        <name>mod_name</name>
        <initializer>= &quot;cdwfe&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="32" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="32" bodyend="32"/>
      </memberdef>
      <memberdef kind="variable" id="namespaceatmos__ocean__fluxes__calc__mod_1a55eb8d12d0b2764e81cecf9dff4dc4d8" prot="private" static="no" mutable="no">
        <type>real, parameter</type>
        <definition>real, parameter atmos_ocean_fluxes_calc_mod::epsln</definition>
        <argsstring></argsstring>
        <name>epsln</name>
        <initializer>=1.0e-30</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="34" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="34" bodyend="34"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1acc10568af1ebdd92581183632c4e1f74" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>subroutine, public</type>
        <definition>subroutine, public atmos_ocean_fluxes_calc_mod::atmos_ocean_fluxes_calc</definition>
        <argsstring>(gas_fields_atm, gas_fields_ice, gas_fluxes, seawater, tsurf, ustar, cd_m)</argsstring>
        <name>atmos_ocean_fluxes_calc</name>
        <param>
          <type>gas_fields_atm</type>
          <defname>gas_fields_atm</defname>
        </param>
        <param>
          <type>gas_fields_ice</type>
          <defname>gas_fields_ice</defname>
        </param>
        <param>
          <type>gas_fluxes</type>
          <defname>gas_fluxes</defname>
        </param>
        <param>
          <type>seawater</type>
          <defname>seawater</defname>
        </param>
        <param>
          <type>tsurf</type>
          <defname>tsurf</defname>
        </param>
        <param>
          <type>ustar</type>
          <defname>ustar</defname>
        </param>
        <param>
          <type>cd_m</type>
          <defname>cd_m</defname>
        </param>
        <briefdescription>
<para>Calculate the ocean gas fluxes. Units should be mol/m^2/s, upward flux is positive. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">gas_fields_atm</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure containing atmospheric surface variables that are used in the calculation of the atmosphere-ocean gas fluxes.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">gas_fields_ice</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure containing ice-top and ocean surface variables that are used in the calculation of the atmosphere-ocean gas fluxes.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="inout">gas_fluxes</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure containing the gas fluxes between the atmosphere and the ocean and parameters related to the calculation of these fluxes.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">seawater</parametername>
</parameternamelist>
<parameterdescription>
<para>1 for the open water category, 0 if ice or land. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="44" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="46" bodyend="293"/>
      </memberdef>
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1abf318a12a94816f9a99ccd779e028e75" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>real function</type>
        <definition>real function atmos_ocean_fluxes_calc_mod::calc_kw</definition>
        <argsstring>(tk, p, u10, h, vb, mw, sc_w, ustar, cd_m)</argsstring>
        <name>calc_kw</name>
        <param>
          <type>tk</type>
          <defname>tk</defname>
        </param>
        <param>
          <type>p</type>
          <defname>p</defname>
        </param>
        <param>
          <type>u10</type>
          <defname>u10</defname>
        </param>
        <param>
          <type>h</type>
          <defname>h</defname>
        </param>
        <param>
          <type>vb</type>
          <defname>vb</defname>
        </param>
        <param>
          <type>mw</type>
          <defname>mw</defname>
        </param>
        <param>
          <type>sc_w</type>
          <defname>sc_w</defname>
        </param>
        <param>
          <type>ustar</type>
          <defname>ustar</defname>
        </param>
        <param>
          <type>cd_m</type>
          <defname>cd_m</defname>
        </param>
        <briefdescription>
<para>Calculate <formula id="0">$k_w$</formula>. </para>        </briefdescription>
        <detaileddescription>
<para>Taken from Johnson, Ocean Science, 2010. (<ulink url="http://doi.org/10.5194/os-6-913-2010">http://doi.org/10.5194/os-6-913-2010</ulink>)</para><para>Uses equations defined in Liss[1974], <formula id="1">\[ F = K_g(c_g - H C_l) = K_l(c_g/H - C_l) \]</formula> where <formula id="2">$c_g$</formula> and <formula id="3">$C_l$</formula> are the bulk gas and liquid concentrations, <formula id="4">$H$</formula> is the Henry&apos;s law constant ( <formula id="5">$H = c_{sg}/C_{sl}$</formula>, where <formula id="6">$c_{sg}$</formula> is the equilibrium concentration in gas phase ( <formula id="7">$g/cm^3$</formula> of air) and <formula id="8">$C_{sl}$</formula> is the equilibrium concentration of unionised dissolved gas in liquid phase ( <formula id="7">$g/cm^3$</formula> of water)), <formula id="9">\[ 1/K_g = 1/k_g + H/k_l \]</formula> and <formula id="10">\[ 1/K_l = 1/k_l + 1/{Hk_g} \]</formula> where <formula id="11">$k_g$</formula> and <formula id="12">$k_l$</formula> are the exchange constants for the gas and liquid phases, respectively.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">tk</parametername>
</parameternamelist>
<parameterdescription>
<para>temperature at surface in kelvin</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">p</parametername>
</parameternamelist>
<parameterdescription>
<para>pressure at surface in pa</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">u10</parametername>
</parameternamelist>
<parameterdescription>
<para>wind speed at 10m above the surface in m/s</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">h</parametername>
</parameternamelist>
<parameterdescription>
<para>Henry&apos;s law constant ( <formula id="13">$H=c_sg/C_sl$</formula>) (unitless)</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">vb</parametername>
</parameternamelist>
<parameterdescription>
<para>Molar volume</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mw</parametername>
</parameternamelist>
<parameterdescription>
<para>molecular weight (g/mol)</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">ustar</parametername>
</parameternamelist>
<parameterdescription>
<para>Friction velocity (m/s). If not provided, ustar = <formula id="14">$u_{10} \sqrt{C_D}$</formula>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">cd_m</parametername>
</parameternamelist>
<parameterdescription>
<para>Drag coefficient ( <formula id="15">$C_D$</formula>). Used only if ustar is provided. If ustar is not provided, cd_m = <formula id="16">$6.1 \times 10^{-4} + 0.63 \times 10^{-4} *u_10$</formula> </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="318" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="319" bodyend="338"/>
      </memberdef>
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1ae9cb64893466d91cc87e5502d37afa12" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>real function</type>
        <definition>real function atmos_ocean_fluxes_calc_mod::calc_ka</definition>
        <argsstring>(t, p, mw, vb, u10, ustar, cd_m)</argsstring>
        <name>calc_ka</name>
        <param>
          <type>t</type>
          <defname>t</defname>
        </param>
        <param>
          <type>p</type>
          <defname>p</defname>
        </param>
        <param>
          <type>mw</type>
          <defname>mw</defname>
        </param>
        <param>
          <type>vb</type>
          <defname>vb</defname>
        </param>
        <param>
          <type>u10</type>
          <defname>u10</defname>
        </param>
        <param>
          <type>ustar</type>
          <defname>ustar</defname>
        </param>
        <param>
          <type>cd_m</type>
          <defname>cd_m</defname>
        </param>
        <briefdescription>
<para>Calculate <formula id="17">$k_a$</formula>. </para>        </briefdescription>
        <detaileddescription>
<para>See calc_kw</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">t</parametername>
</parameternamelist>
<parameterdescription>
<para>temperature at surface in C</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">p</parametername>
</parameternamelist>
<parameterdescription>
<para>pressure at surface in pa</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mw</parametername>
</parameternamelist>
<parameterdescription>
<para>molecular weight (g/mol)</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">vb</parametername>
</parameternamelist>
<parameterdescription>
<para>molar volume</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">u10</parametername>
</parameternamelist>
<parameterdescription>
<para>wind speed at 10m above the surface in m/s</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">ustar</parametername>
</parameternamelist>
<parameterdescription>
<para>Friction velocity (m/s). If not provided, ustar = <formula id="14">$u_{10} \sqrt{C_D}$</formula>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">cd_m</parametername>
</parameternamelist>
<parameterdescription>
<para>Drag coefficient ( <formula id="15">$C_D$</formula>). Used only if ustar is provided. If ustar is not provided, cd_m = <formula id="16">$6.1 \times 10^{-4} + 0.63 \times 10^{-4} *u_10$</formula> </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="344" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="345" bodyend="370"/>
      </memberdef>
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1a5f7e073d68f160bec215202c7e1d7abe" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>real function</type>
        <definition>real function atmos_ocean_fluxes_calc_mod::calc_kl</definition>
        <argsstring>(t, v, sc)</argsstring>
        <name>calc_kl</name>
        <param>
          <type>t</type>
          <defname>t</defname>
        </param>
        <param>
          <type>v</type>
          <defname>v</defname>
        </param>
        <param>
          <type>sc</type>
          <defname>sc</defname>
        </param>
        <briefdescription>
<para>Calculate <formula id="12">$k_l$</formula>. </para>        </briefdescription>
        <detaileddescription>
<para>See calc_kw, and Nightingale, Global Biogeochemical Cycles, 2000 (<ulink url="https://doi.org/10.1029/1999GB900091">https://doi.org/10.1029/1999GB900091</ulink>)</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">t</parametername>
</parameternamelist>
<parameterdescription>
<para>temperature at surface in C</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">v</parametername>
</parameternamelist>
<parameterdescription>
<para>wind speed at surface in m/s </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="377" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="378" bodyend="382"/>
      </memberdef>
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1a7a879f540fe903119d5bb324c44f6c45" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>real function</type>
        <definition>real function atmos_ocean_fluxes_calc_mod::schmidt_g</definition>
        <argsstring>(t, p, mw, vb)</argsstring>
        <name>schmidt_g</name>
        <param>
          <type>t</type>
          <defname>t</defname>
        </param>
        <param>
          <type>p</type>
          <defname>p</defname>
        </param>
        <param>
          <type>mw</type>
          <defname>mw</defname>
        </param>
        <param>
          <type>vb</type>
          <defname>vb</defname>
        </param>
        <briefdescription>
<para>Schmidt number of the gas in air. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">t</parametername>
</parameternamelist>
<parameterdescription>
<para>temperature at surface in C</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">p</parametername>
</parameternamelist>
<parameterdescription>
<para>pressure at surface in pa</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mw</parametername>
</parameternamelist>
<parameterdescription>
<para>molecular weight (g/mol)</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">vb</parametername>
</parameternamelist>
<parameterdescription>
<para>molar volume </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="386" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="387" bodyend="396"/>
      </memberdef>
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1a6a4a1330c1ee1043b30e4b86f462ec24" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>real function</type>
        <definition>real function atmos_ocean_fluxes_calc_mod::d_air</definition>
        <argsstring>(t, p, mw, vb)</argsstring>
        <name>d_air</name>
        <param>
          <type>t</type>
          <defname>t</defname>
        </param>
        <param>
          <type>p</type>
          <defname>p</defname>
        </param>
        <param>
          <type>mw</type>
          <defname>mw</defname>
        </param>
        <param>
          <type>vb</type>
          <defname>vb</defname>
        </param>
        <briefdescription>
<para>From Fuller, Industrial &amp; Engineering Chemistry (<ulink url="https://doi.org/10.1021/ie50677a007">https://doi.org/10.1021/ie50677a007</ulink>) </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">t</parametername>
</parameternamelist>
<parameterdescription>
<para>temperature in c</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">p</parametername>
</parameternamelist>
<parameterdescription>
<para>pressure in pa</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">mw</parametername>
</parameternamelist>
<parameterdescription>
<para>molecular weight (g/mol)</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">vb</parametername>
</parameternamelist>
<parameterdescription>
<para>diffusion coefficient ( <formula id="18">$cm3/mol$</formula>) </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="400" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="401" bodyend="416"/>
      </memberdef>
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1a9c7ab4de0daccbdd49f8851ea12c1c5c" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>real function</type>
        <definition>real function atmos_ocean_fluxes_calc_mod::p_air</definition>
        <argsstring>(t)</argsstring>
        <name>p_air</name>
        <param>
          <type>t</type>
          <defname>t</defname>
        </param>
        <briefdescription>
<para>kinematic viscosity in air </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="420" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="421" bodyend="427"/>
      </memberdef>
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1a942762290e4c14fbb89e992f736838d5" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>real function</type>
        <definition>real function atmos_ocean_fluxes_calc_mod::v_air</definition>
        <argsstring>(t)</argsstring>
        <name>v_air</name>
        <param>
          <type>t</type>
          <defname>t</defname>
        </param>
        <briefdescription>
<para>Kinematic viscosity in air ( <formula id="19">$m^2/s$</formula>. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">t</parametername>
</parameternamelist>
<parameterdescription>
<para>temperature in C </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="431" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="432" bodyend="433"/>
      </memberdef>
      <memberdef kind="function" id="namespaceatmos__ocean__fluxes__calc__mod_1acaeb4ccb8ce4e4fa5c470157420075de" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>real function</type>
        <definition>real function atmos_ocean_fluxes_calc_mod::n_air</definition>
        <argsstring>(t)</argsstring>
        <name>n_air</name>
        <param>
          <type>t</type>
          <defname>t</defname>
        </param>
        <briefdescription>
<para>dynamic viscosity in air </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">t</parametername>
</parameternamelist>
<parameterdescription>
<para>temperature in C </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="full/atmos_ocean_fluxes_calc.F90" line="437" column="1" bodyfile="full/atmos_ocean_fluxes_calc.F90" bodystart="438" bodyend="446"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <location file="full/atmos_ocean_fluxes_calc.F90" line="22" column="1"/>
  </compounddef>
</doxygen>
